name: Scheduled Cron Job

on:
  schedule:
    - cron: '0 2 * * *'  # Every day at 2:00 AM UTC
  workflow_dispatch:      # Optional: Manual run from GitHub UI

jobs:
  cron-task:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'  # Change if needed

      - name: Install Node dependencies
        run: npm ci  # Uses package-lock.json for clean install

      - name: Install Docker
        run: |
          sudo apt-get update
          sudo apt-get install -y docker.io docker-compose
          sudo systemctl start docker
          sudo systemctl enable docker

      - name: Verify Docker installation
        run: |
          docker --version
          docker-compose --version

      # Optional: Build and run containers (adjust as needed)
      - name: Build Docker image
        run: docker build -t my-app .

      - name: Run Docker Compose
        run: docker-compose up -d

